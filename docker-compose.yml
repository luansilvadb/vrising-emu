# ==============================================================================
# V Rising ARM64 Server - Development Docker Compose
# ==============================================================================
# Use this for local development with Dockerfile build
# For production, use docker-compose.easypanel.yml
#
# Usage:
#   docker compose build        # Build image
#   docker compose up -d        # Start container
#   docker compose logs -f      # View logs
#   docker compose down         # Stop container
# ==============================================================================

services:
  vrising:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        WINE_VERSION: "10.15"

    container_name: vrising-dev
    hostname: vrising-dev

    environment:
      - TZ=America/Sao_Paulo
      - SERVERNAME=VRising-Dev
      - ENABLE_PLUGINS=true
      - UPDATE_SERVER=true
      - LOGDAYS=7
      # Box64
      - BOX64_DYNAREC=1
      - BOX64_DYNAREC_FASTROUND=1
      - BOX64_DYNAREC_FASTNAN=1
      - BOX64_DYNAREC_SAFEFLAGS=0
      - BOX64_DYNAREC_BIGBLOCK=2
      - BOX64_DYNAREC_BLEEDING_EDGE=1
      - BOX64_NOBANNER=1
      # Wine
      - WINEDEBUG=-all

    volumes:
      # Use local directories for easier debugging
      - ./vrising/server:/mnt/vrising/server
      - ./vrising/persistentdata:/mnt/vrising/persistentdata

    ports:
      - "9876:9876/udp"
      - "9877:9877/udp"
      - "25575:25575/tcp"
      - "9099:9090/tcp"

    restart: unless-stopped
    stop_grace_period: 60s

    # Lower limits for dev
    deploy:
      resources:
        limits:
          cpus: '3.0'
          memory: 12G
